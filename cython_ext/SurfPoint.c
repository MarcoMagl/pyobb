/*************************************************************
* AceGen    6.822 MacOSX (19 Jan 18)                         *
*           Co. J. Korelc  2013           5 Mar 18 22:57:46  *
**************************************************************
User     : Full professional version
Notebook : SurfPoint
Evaluation time                 : 3 s     Mode  : Optimal
Number of formulae              : 92      Method: Automatic
Subroutine                      : SurfPointFUN size: 1620
Total size of Mathematica  code : 1620 subexpressions
Total size of C code            : 3910 bytes */
#include "/Users/marco.magliulo/Softwares/AceFEM_Trial_MacOSX/AceGen/Include/C/sms.h"
#include "sms.h"

/******************* S U B R O U T I N E *********************/
void SurfPointFUN(double v[5001],double X[9],double u[9]
     ,double Vec[9],double ta[2][3],double tb[2][3],double (*a),double (*b),double 
     (*xi),double (*theta),double (*alph),double s[3])
{
int b128;
v[168]=u[5]+X[5];
v[167]=u[4]+X[4];
v[166]=u[3]+X[3];
v[85]=ta[0][0]+ta[1][0];
v[79]=v[85]/2e0;
v[91]=ta[1][0]+v[79];
v[87]=ta[0][1]+ta[1][1];
v[81]=v[87]/2e0;
v[93]=ta[1][1]+v[81];
v[89]=ta[0][2]+ta[1][2];
v[83]=v[89]/2e0;
v[95]=ta[1][2]+v[83];
v[106]=tb[0][0]+tb[1][0];
v[100]=v[106]/2e0;
v[108]=tb[0][1]+tb[1][1];
v[102]=v[108]/2e0;
v[110]=tb[0][2]+tb[1][2];
v[104]=v[110]/2e0;
v[123]=Power((*xi),3);
v[159]=sin((*theta));
v[52]=1e0-(*alph);
v[174]=(u[6]+v[166]+X[6])/2e0;
v[175]=(u[7]+v[167]+X[7])/2e0;
v[176]=(u[8]+v[168]+X[8])/2e0;
v[45]=(u[0]+v[166]+X[0])/2e0;
v[46]=(u[1]+v[167]+X[1])/2e0;
v[47]=(u[2]+v[168]+X[2])/2e0;
v[61]=(Vec[0]+Vec[3])/2e0;
v[62]=(Vec[1]+Vec[4])/2e0;
v[63]=(Vec[2]+Vec[5])/2e0;
v[76]=(ta[0][0]+v[79])/2e0;
v[77]=(ta[0][1]+v[81])/2e0;
v[78]=(ta[0][2]+v[83])/2e0;
v[97]=(tb[0][0]+v[100])/2e0;
v[98]=(tb[0][1]+v[102])/2e0;
v[99]=(tb[0][2]+v[104])/2e0;
v[118]=1e0-(*xi);
v[122]=3e0*v[118]*Power((*xi),2);
v[171]=v[123]+v[122]*v[52];
v[121]=3e0*(v[118]*v[118])*(*xi);
v[170]=v[121]+v[122];
v[120]=Power(v[118],3);
v[169]=v[120]+v[121];
v[119]=v[169]*v[61]+(*alph)*(-(v[121]*v[61])+v[170]*Vec[3])+(v[171]*(Vec[3]+Vec[6]))/2e0;
v[146]=(v[119]*v[119]);
v[124]=v[169]*v[62]+(*alph)*(-(v[121]*v[62])+v[170]*Vec[4])+(v[171]*(Vec[4]+Vec[7]))/2e0;
v[138]=(v[124]*v[124]);
v[125]=v[169]*v[63]+(*alph)*(-(v[121]*v[63])+v[170]*Vec[5])+(v[171]*(Vec[5]+Vec[8]))/2e0;
v[139]=(v[125]*v[125]);
v[126]=v[138]+v[139]+v[146];
if(v[126]<0.1e-7){
 v[129]=1e0;
 v[130]=0e0;
 v[131]=0e0;
 v[132]=0e0;
 v[133]=1e0;
 v[134]=0e0;
 v[135]=0e0;
 v[136]=0e0;
 v[137]=1e0;
} else {
 v[140]=sqrt(v[126]);
 v[172]=sin(v[140])/v[140];
 v[149]=-(v[119]*v[172]);
 v[147]=v[124]*v[172];
 v[144]=-(v[125]*v[172]);
 v[141]=(2e0*Power(sin(v[140]/2e0),2))/v[126];
 v[173]=v[125]*v[141];
 v[150]=v[124]*v[173];
 v[148]=v[119]*v[173];
 v[145]=v[119]*v[124]*v[141];
 v[129]=1e0-v[141]*(v[126]-v[146]);
 v[130]=v[144]+v[145];
 v[131]=v[147]+v[148];
 v[132]=-v[144]+v[145];
 v[133]=1e0-(v[126]-v[138])*v[141];
 v[134]=v[149]+v[150];
 v[135]=-v[147]+v[148];
 v[136]=-v[149]+v[150];
 v[137]=1e0-(v[126]-v[139])*v[141];
};
v[151]=v[120]*v[76]+v[121]*(v[76]+(*alph)*(-v[76]+v[79]))+(v[123]*v[91])/2e0+(v[122]*((*alph)*v[85]
 +v[52]*v[91]))/2e0;
v[152]=v[120]*v[77]+v[121]*(v[77]+(*alph)*(-v[77]+v[81]))+(v[123]*v[93])/2e0+(v[122]*((*alph)*v[87]
 +v[52]*v[93]))/2e0;
v[153]=v[120]*v[78]+v[121]*(v[78]+(*alph)*(-v[78]+v[83]))+(v[123]*v[95])/2e0+(v[122]*((*alph)*v[89]
 +v[52]*v[95]))/2e0;
v[154]=((tb[1][0]+v[100])*v[171])/2e0+v[169]*v[97]+(*alph)*(v[100]*v[121]+(v[106]*v[122])/2e0
 -v[121]*v[97]);
v[155]=((tb[1][1]+v[102])*v[171])/2e0+v[169]*v[98]+(*alph)*(v[102]*v[121]+(v[108]*v[122])/2e0
 -v[121]*v[98]);
v[156]=((tb[1][2]+v[104])*v[171])/2e0+v[169]*v[99]+(*alph)*(v[104]*v[121]+(v[110]*v[122])/2e0
 -v[121]*v[99]);
v[157]=cos((*theta));
v[158]=1e0/sqrt(Power(fabs(v[157]),2)+Power(fabs(v[159]),2));
v[162]=0.5e0*(*b)*v[158]*v[159];
v[161]=0.5e0*(*a)*v[157]*v[158];
v[160]=(v[129]*v[151]+v[130]*v[152]+v[131]*v[153])*v[161]+(v[129]*v[154]+v[130]*v[155]
 +v[131]*v[156])*v[162]+v[123]*v[174]+v[120]*v[45]+v[121]*((*alph)*(v[166]-v[45])+v[45])+v[122]*(
 (*alph)*v[166]+v[174]*v[52]);
v[163]=(v[132]*v[151]+v[133]*v[152]+v[134]*v[153])*v[161]+(v[132]*v[154]+v[133]*v[155]
 +v[134]*v[156])*v[162]+v[123]*v[175]+v[120]*v[46]+v[121]*((*alph)*(v[167]-v[46])+v[46])+v[122]*(
 (*alph)*v[167]+v[175]*v[52]);
v[164]=(v[135]*v[151]+v[136]*v[152]+v[137]*v[153])*v[161]+(v[135]*v[154]+v[136]*v[155]
 +v[137]*v[156])*v[162]+v[123]*v[176]+v[120]*v[47]+v[121]*((*alph)*(v[168]-v[47])+v[47])+v[122]*(
 (*alph)*v[168]+v[176]*v[52]);
s[0]=v[160];
s[1]=v[163];
s[2]=v[164];
};
